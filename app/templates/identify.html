     
{% extends "base.html" %}

{% block title %}–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞{% endblock %}

{% block content %}
  <main class="flex-1 flex flex-col h-screen">
    <div class="max-w-2xl mx-auto p-6">
      
      <h1 class="text-2xl font-bold mb-6 text-center">üì∏ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –ø–æ —Ñ–æ—Ç–æ</h1>

      <form id="identify-form" method="post" enctype="multipart/form-data" data-identify-url="/identify">

        <input type="text" id="result-name" class="input w-full" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞">

        <!-- –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è -->
        <label id="upload-zone" for="image-upload"
            class="relative flex flex-col items-center justify-center
                    border-2 border-dashed rounded-lg p-6 text-center cursor-pointer hover:border-blue-500">
          <input id="image-upload" name="images" type="file" accept="image/*" multiple class="sr-only">
          <span id="upload-prompt">–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏</span>
        </label>
        <div id="gallery" class="flex flex-wrap gap-2 mt-4"></div>
        <div class="mt-2 flex gap-2">
          <button type="button" id="select-all" class="btn btn-secondary">–û—Ç–º–µ—Ç–∏—Ç—å –≤—Å–µ</button>
          <button type="button" id="uncheck-all" class="btn btn-secondary">–°–Ω—è—Ç—å –≤—Å–µ –æ—Ç–º–µ—Ç–∫–∏</button>
          <button type="button" id="delete-selected" class="btn btn-danger">–£–¥–∞–ª–∏—Ç—å –æ—Ç–º–µ—á–µ–Ω–Ω—ã–µ</button>
        </div>
        <span id="selected-count" class="ml-2 font-medium"></span>

        <!-- –§–æ—Ç–æ —Å –∫–∞–º–µ—Ä—ã (–¥–µ—Å–∫—Ç–æ–ø) -->
        <div class="text-center mt-4">
          <button type="button" id="camera-capture" class="btn btn-secondary">üì∑ –°–¥–µ–ª–∞—Ç—å —Ñ–æ—Ç–æ</button>
        </div>

        <!-- –ö–Ω–æ–ø–∫–∞ –∑–∞–ø—É—Å–∫–∞ -->
        <div class="text-center mt-6">
          <button type="submit" class="btn btn-primary">üîç –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å</button>
        </div>

      </form>

      <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã -->
      <div id="result-fields" class="mt-8 hidden space-y-2">
        <input type="text" id="result-ean" class="input w-full" placeholder="EAN" readonly>
        <input type="text" id="result-upc" class="input w-full" placeholder="UPC" readonly>
        <input type="text" id="result-serial" class="input w-full" placeholder="–°–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä" readonly>
        <input type="text" id="result-barcode" class="input w-full" placeholder="–®—Ç—Ä–∏—Ö–∫–æ–¥" readonly>
        <input type="url" id="result-link" class="input w-full" placeholder="–°—Å—ã–ª–∫–∞ –Ω–∞ —Ç–æ–≤–∞—Ä" readonly>
      </div>

      <!-- –ú–∞–≥–∞–∑–∏–Ω—ã -->
      <div id="result-stores" class="mt-6 hidden">
        <h3 class="font-bold mb-2">–ë–ª–∏–∂–∞–π—à–∏–µ –º–∞–≥–∞–∑–∏–Ω—ã:</h3>
        <ul id="store-list" class="list-disc pl-6 text-blue-600"></ul>
      </div>

      <!-- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ -->
      <div class="mt-4 hidden" id="confirm-section">
        <button class="btn btn-success" id="confirm-product">‚úÖ –í—Å—ë –≤–µ—Ä–Ω–æ</button>
      </div>

      <button type="button" id="save-product" class="btn btn-success mt-4">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–≤–∞—Ä</button>
      
    </div>
  </main>

  <!-- –ú–æ–¥–∞–ª –∫–∞–º–µ—Ä—ã -->
  <div id="camera-modal" class="hidden fixed inset-0 z-20 bg-black bg-opacity-50 flex items-center justify-center">
    <div class="bg-white p-4 rounded shadow-lg relative">
      <video id="camera-video" autoplay playsinline class="w-80 h-60 bg-gray-200 rounded"></video>
      <canvas id="camera-canvas" class="hidden"></canvas>
      <div class="mt-2 flex justify-between">
        <button type="button" id="take-photo" class="btn btn-primary">–°—Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—Ä–æ–≤–∞—Ç—å</button>
        <label class="flex items-center gap-2">
          <input type="checkbox" id="preview-checkbox" class="form-checkbox">
          –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä
        </label>
        <button type="button" id="cancel-photo" class="btn btn-secondary">–û—Ç–º–µ–Ω–∞</button>
      </div>
    </div>
  </div>

  <!-- Preview –º–æ–¥–∞–ª -->
  <div id="photo-preview-modal" class="hidden fixed inset-0 z-50 bg-black bg-opacity-75 flex items-center justify-center">
    <div class="bg-white p-4 rounded shadow-lg relative max-w-lg">
      <img id="photo-preview-img" class="max-w-full h-auto rounded" alt="–§–æ—Ç–æ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤–æ–µ">
      <div class="mt-4 flex justify-between">
        <button id="confirm-photo" class="btn btn-primary">–î–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ</button>
        <button id="cancel-preview" class="btn btn-secondary">–û—Ç–º–µ–Ω–∞</button>
      </div>
    </div>
  </div>

{% endblock %}

  
  {% block scripts %}
    <script type="module" src="{{ url_for('static', path='js/sortable.min.js') }}"></script>
    <script type="module" src="{{ url_for('static', path='js/identify.js') }}"></script>
  {% endblock %}